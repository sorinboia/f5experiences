<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.73.0" />
    <meta name="description" content="Nginx experience on AWS">
<meta name="author" content="Sorin Boiangiu">

    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>Import the OpenApi definition :: Nginx Experience</title>

    
    <link href="../../css/nucleus.css?1618304166" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1618304166" rel="stylesheet">
    <link href="../../css/hybrid.css?1618304166" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1618304166" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1618304166" rel="stylesheet">
    <link href="../../css/auto-complete.css?1618304166" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1618304166" rel="stylesheet">
    <link href="../../css/theme.css?1618304166" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1618304166" rel="stylesheet">
    
    <link href="../../css/theme-green.css?1618304166" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1618304166"></script>

    <style>
    :root #header + #content > #left > #rlblock_left{
        display:none !important;
    }
    
    </style>
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-177908951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>
    <body class="" data-url="../../050_controller/040_apis/">
        <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <h4>NGINX Experience</h4>

<img style="vertical-align:middle" src="../../images/aws-logo.png" height="45px">
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1618304166"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1618304166"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="../../js/search.js?1618304166"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/010_intro/" title="Intro to the workshop" class="dd-item 
        
        
        
        ">
      <a href="../../010_intro/">
          <b>1. </b>Intro to the workshop
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/010_intro/005_workshop_path/" title="AWS Workshop environment" class="dd-item ">
        <a href="../../010_intro/005_workshop_path/">
        AWS Workshop environment
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/010_intro/aws_event/" title="...at an AWS event" class="dd-item 
        
        
        
        ">
      <a href="../../010_intro/aws_event/">
          ...at an AWS event
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/010_intro/aws_event/010_aws_wokshop_portal_1/" title="AWS Workshop Portal" class="dd-item ">
        <a href="../../010_intro/aws_event/010_aws_wokshop_portal_1/">
        AWS Workshop Portal
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/010_intro/selfpaced/" title="...on your own" class="dd-item 
        
        
        
        ">
      <a href="../../010_intro/selfpaced/">
          ...on your own
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/010_intro/selfpaced/020_cloudformation_1/" title="Cloud Formation" class="dd-item ">
        <a href="../../010_intro/selfpaced/020_cloudformation_1/">
        Cloud Formation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/010_intro/selfpaced/030_iam_role_1/" title="IAM Role" class="dd-item ">
        <a href="../../010_intro/selfpaced/030_iam_role_1/">
        IAM Role
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/010_intro/040_cloud9_1/" title="Cloud 9" class="dd-item ">
        <a href="../../010_intro/040_cloud9_1/">
        Cloud 9
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/020_terraform/" title="Deploy NGINX infrastructure using Terraform" class="dd-item 
        
        
        
        ">
      <a href="../../020_terraform/">
          <b>2. </b>Nginx with Terraform
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/020_terraform/010_terraform_apply_1/" title="Terraform Apply" class="dd-item ">
        <a href="../../020_terraform/010_terraform_apply_1/">
        Terraform Apply
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/020_terraform/020_eks_1/" title="AWS EKS" class="dd-item ">
        <a href="../../020_terraform/020_eks_1/">
        AWS EKS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/020_terraform/030_eks_verification_1/" title="EKS Verification" class="dd-item ">
        <a href="../../020_terraform/030_eks_verification_1/">
        EKS Verification
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/030_application/" title="Deploy The Arcadia Crypto application" class="dd-item 
        
        
        
        ">
      <a href="../../030_application/">
          <b>3. </b>Arcadia deployment
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/030_application/010_app_deployment_1/" title="App deployment" class="dd-item ">
        <a href="../../030_application/010_app_deployment_1/">
        App deployment
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/040_ingress/" title="Increase availability, security and application performance with Kubernetes Nginx Ingress" class="dd-item 
        
        
        
        ">
      <a href="../../040_ingress/">
          <b>4. </b>Nginx K8s Ingress
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/040_ingress/010_ingress_install_1/" title="Nginx Kubernetes Ingress Installation" class="dd-item ">
        <a href="../../040_ingress/010_ingress_install_1/">
        Nginx K8s Ingress Installation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/040_ingress/020_ingress_01/" title="Publish the app" class="dd-item ">
        <a href="../../040_ingress/020_ingress_01/">
        Publish the app
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/040_ingress/030_health_https_1/" title="Enable https and monitoring" class="dd-item ">
        <a href="../../040_ingress/030_health_https_1/">
        Enable https and monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/040_ingress/040_oidc_1/" title="Authentication with Openid Connect and Okta" class="dd-item ">
        <a href="../../040_ingress/040_oidc_1/">
        Openid Connect
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/040_ingress/060_mtls_1/" title="Mutual TLS" class="dd-item ">
        <a href="../../040_ingress/060_mtls_1/">
        Mutual TLS
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/050_service_mesh/" title="Nginx Service Mesh" class="dd-item 
        
        
        
        ">
      <a href="../../050_service_mesh/">
          <b>3. </b>Nginx Service Mesh
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/050_service_mesh/010_mesh_explanation_1/" title="Service Mesh Overview" class="dd-item ">
        <a href="../../050_service_mesh/010_mesh_explanation_1/">
        Service Mesh Overview
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_service_mesh/020_nsm_deploy/" title="Nginx Service Mesh deployment" class="dd-item ">
        <a href="../../050_service_mesh/020_nsm_deploy/">
        Nginx Service Mesh deployment
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_service_mesh/030_side_car_injection/" title="Side Car Injection" class="dd-item ">
        <a href="../../050_service_mesh/030_side_car_injection/">
        Side Car Injection
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/050_controller/" title="Nginx Controller" class="dd-item 
        parent
        
        
        ">
      <a href="../../050_controller/">
          <b>5. </b>Nginx Controller
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/050_controller/010_accessing_controller/" title="Accessing the Nginx Controller" class="dd-item ">
        <a href="../../050_controller/010_accessing_controller/">
        Nginx Controller Access
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_controller/020_microgateway/" title="Microgateway deployment" class="dd-item ">
        <a href="../../050_controller/020_microgateway/">
        Microgateway deployment
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_controller/030_configuration/" title="Build the configuration" class="dd-item ">
        <a href="../../050_controller/030_configuration/">
        Build the configuration
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_controller/040_apis/" title="Import the OpenApi definition" class="dd-item active">
        <a href="../../050_controller/040_apis/">
        Import the OpenApi definition
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_controller/050_publish_apis/" title="Publish the external APIs" class="dd-item ">
        <a href="../../050_controller/050_publish_apis/">
        Publish the external APIs
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_controller/060_add_auth/" title="Add authentication to the API" class="dd-item ">
        <a href="../../050_controller/060_add_auth/">
        Add authentication to the API
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/050_controller/070_summary/" title="Summary" class="dd-item ">
        <a href="../../050_controller/070_summary/">
        Summary
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/060_security/" title="Security" class="dd-item 
        
        
        
        ">
      <a href="../../060_security/">
          <b>6. </b>Security
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/060_security/010_waf_deployment/" title="Waf deployment" class="dd-item ">
        <a href="../../060_security/010_waf_deployment/">
        Waf deployment
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/060_security/020_testing/" title="Testing the Waf" class="dd-item ">
        <a href="../../060_security/020_testing/">
        Testing the Waf
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/070_cleanup/" title="Cleanup" class="dd-item 
        
        
        
        ">
      <a href="../../070_cleanup/">
          <b>7. </b>Cleanup
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/070_cleanup/010_cleanup/" title="Remove configuration" class="dd-item ">
        <a href="../../070_cleanup/010_cleanup/">
        Remove configuration
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/080_feedback/" title="Feedback" class="dd-item 
        
        
        
        ">
      <a href="../../080_feedback/">
          <b>8. </b>Feedback
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>




    <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
        
    <div>
    <div id="top-bar">
        
    
    <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
        <span id="sidebar-toggle-span">
        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
        <i class="fas fa-bars"></i>
        </a>
        </span>
    
    <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
    
    <span class="links">
        
    
    
    
    
    
    
    
    
    
    
    
    
    <a href='../../'>Nginx Experience</a> > <a href='../../050_controller/'>Nginx Controller</a> > Import the OpenApi definition
    
    
    
    
    
    
    
    </span>
    </div>
    
    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents"></nav>
    </div>
</div>

    
    </div>
    </div>
    
    <div id="head-tags">
        
    </div>
    
    <div id="body-inner">
        
    <h1>
    
    Import the OpenApi definition
    </h1>
    

    


<p>Next we are going to publish the application APIs to the world.<br>
There are two ways of creating this configuration, the first one is manual similar to the way we performed the configuration until this point and the second one is described bellow.</p>
<p>As part of their development cycle, the developers of the Arcadia application are generating an <a href="https://swagger.io/docs/specification/about/">OpenApi</a> specification to describe their APIs.<br>
We are going to use this API specification in order to publish the services to the world.</p>
<ol>
<li>Run the following curl commands.</li>
</ol>
<pre><code>curl -k -sc cookie.txt -X POST --url &quot;https://$controller_ip/api/v1/platform/login&quot; --header 'Content-Type: application/json' --data '{&quot;credentials&quot;: {&quot;type&quot;: &quot;BASIC&quot;,&quot;username&quot;: &quot;nginx@f5.com&quot;,&quot;password&quot;: &quot;Admin2020&quot;}}'  
curl -k -sb cookie.txt -c cookie.txt --location --request PUT &quot;https://$controller_ip/api/v1/services/api-definitions/arcadia-api/versions/v1&quot; --header 'Content-Type: application/json' --header 'Content-Type: text/plain' --data &quot;@files/6controller/arcadia_api_spec.json&quot;
</code></pre><p>We have just uploaded the OpenApi spec to the Nginx Controller.</p>
<ol start="2">
<li>
<p>Go to &ldquo;N&rdquo; -&gt; &ldquo;Services&rdquo; -&gt; &ldquo;APIs&rdquo;.<br>
You can see the &ldquo;Arcadia API&rdquo; definition listed.</p>
</li>
<li>
<p>Check the DNS name of the backend servers we need to point our APIs to:</p>
</li>
</ol>
<pre><code>kubectl get svc
</code></pre><pre>Output<br><output class="bash">
 NAME              TYPE           CLUSTER-IP       EXTERNAL-IP                                                                 PORT(S)                      AGE
 arcadia-app2      ClusterIP      172.20.103.189   none                                                                        80/TCP                       171m
 arcadia-app3      ClusterIP      172.20.238.13    none                                                                        80/TCP                       171m
 arcadia-backend   ClusterIP      172.20.228.83    none                                                                        80/TCP                       109m
 arcadia-main      ClusterIP      172.20.166.2     none                                                                        80/TCP                       7s
 backend           ClusterIP      172.20.44.133    none                                                                        80/TCP                       171m
 kubernetes        ClusterIP      172.20.0.1       none                                                                        443/TCP                      8h
 microgateway      LoadBalancer   172.20.81.110    a2fa7314165114fb9b16ebd92a890078-367878391.eu-central-1.elb.amazonaws.com   80:32293/TCP,443:32428/TCP   12m
 </output></pre>
<p>We are interested in &ldquo;main&rdquo; and &ldquo;app2&rdquo; and their DNS names are <code>arcadia-main</code> and <code>arcadia-app2</code>.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../050_controller/030_configuration/" title="Build the configuration"> <i class="fa fa-chevron-left"></i></a>
		
		
      
        <a class="nav nav-next" href="../../050_controller/050_publish_apis/" title="Publish the external APIs" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
      
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1618304166"></script>
    <script src="../../js/perfect-scrollbar.min.js?1618304166"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1618304166"></script>
    <script src="../../js/jquery.sticky.js?1618304166"></script>
    <script src="../../js/featherlight.min.js?1618304166"></script>
    <script src="../../js/highlight.pack.js?1618304166"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1618304166"></script>
    <script src="../../js/learn.js?1618304166"></script>
    <script src="../../js/hugo-learn.js?1618304166"></script>

    <link href="../../mermaid/mermaid.css?1618304166" rel="stylesheet" />
    <script src="../../mermaid/mermaid.js?1618304166"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

